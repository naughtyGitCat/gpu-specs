import collections
import requests
import operator
from bs4 import BeautifulSoup
import prettytable


def get_retail_products(detail: str) -> collections.abc.Iterable[dict]:
    r = requests.get(f"https://www.techpowerup.com/gpu-specs/{detail}")
    soup = BeautifulSoup(r.text, 'html.parser')
    for section in soup.findAll('section', attrs={'id': 'boards'}):
        for table in section.findAll('table'):
            thead = table.find('thead')
            keys = list()
            for tr in thead.findAll('tr'):
                for th in tr.findAll('th'):
                    keys.append(th.text)
            tbody = table.find('tbody')
            for tr in tbody.findAll('tr'):
                values = list()
                for td in tr.findAll('td'):
                    values.append(td.text.strip())
                # print(','.join(values))
                # print(dict(zip(keys, values)))
                yield dict(zip(keys, values))


if __name__ == '__main__':
    ordered = sorted(get_retail_products("geforce-rtx-4070-ti-super.c4187"), key=operator.itemgetter('Other Changes'),
                     reverse=True)
    t = prettytable.PrettyTable()
    t.field_names = ['Name', 'GPU Clock', 'Boost Clock', 'Memory Clock', 'Other Changes']
    for row in ordered:
        t.add_row([row['Name'], row['GPU Clock'], row['Boost Clock'], row['Memory Clock'], row['Other Changes']])
    print(t)


# here is result example


"""
[{'Name': 'ZOTAC RTX 4070 Ti SUPER AMP HOLO',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '356 mm/14 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER AMP EXTREME AIRO',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '355 mm/14 inches'},
 {'Name': 'GIGABYTE AORUS RTX 4070 Ti SUPER MASTER',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '342 mm/13.5 inches'},
 {'Name': 'GALAX RTX 4070 Ti SUPER BOOMSTAR OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '340 mm/13.4 inches'},
 {'Name': 'Colorful iGame RTX 4070 Ti SUPER Vulcan OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '337 mm/13.3 inches, 310 W'},
 {'Name': 'Colorful iGame RTX 4070 Ti SUPER Vulcan W OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '337 mm/13.3 inches, 310 W'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING TRIO WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '337 mm/13.3 inches'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING X TRIO WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '337 mm/13.3 inches'},
 {'Name': 'MAXSUN RTX 4070 Ti SUPER iCraft OC Aijia S0',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '336 mm/13.2 inches, 300 W'},
 {'Name': 'ASUS ROG STRIX RTX 4070 Ti SUPER GAMING',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '336 mm/13.2 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'ASUS ROG STRIX RTX 4070 Ti SUPER GAMING OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '336 mm/13.2 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'Inno3D RTX 4070 Ti SUPER ICHILL X3',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '334 mm/13.1 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER Apocalypse OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '334 mm/13.1 inches'},
 {'Name': 'PNY XLR8 RTX 4070 Ti SUPER VERTO EPIC-X Triple Fan OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '333 mm/13.1 inches'},
 {'Name': 'Colorful iGame RTX 4070 Ti SUPER Advanced OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '331 mm/13 inches, 310 W'},
 {'Name': 'Yeston RTX 4070 Ti SUPER Deluxe Edition',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '330 mm/13 inches'},
 {'Name': 'Yeston RTX 4070 Ti SUPER SAKURA',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '330 mm/13 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Panther OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Phantom',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Phantom GS',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Phoenix',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Phoenix GS',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'MAXSUN RTX 4070 Ti SUPER Turbo T0',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Palit RTX 4070 Ti SUPER GamingPro',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Palit RTX 4070 Ti SUPER GamingPro OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Palit RTX 4070 Ti SUPER GamingPro White OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'Palit RTX 4070 Ti SUPER JetStream OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '329 mm/13 inches'},
 {'Name': 'AX Gaming Rebel RTX 4070 Ti SUPER X3W MAX',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '325 mm/12.8 inches'},
 {'Name': 'Colorful iGame RTX 4070 Ti SUPER Ultra W OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '325 mm/12.8 inches'},
 {'Name': 'GALAX RTX 4070 Ti SUPER EX Gamer 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'GALAX RTX 4070 Ti SUPER EX Gamer Pink 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'GALAX RTX 4070 Ti SUPER EX Gamer White 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'KFA2 RTX 4070 Ti SUPER EX Gamer 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'KFA2 RTX 4070 Ti SUPER EX Gamer Pink 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'KFA2 RTX 4070 Ti SUPER EX Gamer White 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'KUROUTOSHIKOU RTX 4070 Ti SUPER GALAKURO GAMING',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '323 mm/12.7 inches'},
 {'Name': 'GALAX RTX 4070 Ti SUPER SG 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '320 mm/12.6 inches'},
 {'Name': 'KFA2 RTX 4070 Ti SUPER SG 1-Click OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '320 mm/12.6 inches'},
 {'Name': 'Leadtek WinFast RTX 4070 Ti SUPER HURRICANE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '319 mm/12.6 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Xingji Haoyue OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '317 mm/12.5 inches'},
 {'Name': 'Gainward RTX 4070 Ti SUPER Snow OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '315 mm/12.4 inches'},
 {'Name': 'Manli RTX 4070 Ti SUPER Gallardo (M3551+N693)',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '315 mm/12.4 inches'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 3X',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '308 mm/12.1 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 3X OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '308 mm/12.1 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING SLIM',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING SLIM WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING X SLIM',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER GAMING X SLIM WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2670 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches, Dual-slot'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER Trinity Black',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER Trinity OC Moon White',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER Trinity OC White',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2625 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '307 mm/12.1 inches'},
 {'Name': 'ASUS TUF RTX 4070 Ti SUPER BTF WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'ASUS TUF RTX 4070 Ti SUPER BTF WHITE OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'ASUS TUF RTX 4070 Ti SUPER GAMING',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'ASUS TUF RTX 4070 Ti SUPER GAMING OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'ASUS TUF RTX 4070 Ti SUPER GAMING WHITE OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches, 2x HDMI 3x DisplayPort'},
 {'Name': 'PNY RTX 4070 Ti SUPER VERTO Triple Fan OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2625 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '305 mm/12 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER X-GAMING OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '303 mm/11.9 inches'},
 {'Name': 'ZOTAC RTX 4070 Ti SUPER X-GAMING OC Opal White',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '303 mm/11.9 inches'},
 {'Name': 'ASUS ProArt RTX 4070 Ti SUPER',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '300 mm/11.8 inches, Dual-slot'},
 {'Name': 'ASUS ProArt RTX 4070 Ti SUPER OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '300 mm/11.8 inches, Dual-slot'},
 {'Name': 'GIGABYTE RTX 4070 Ti SUPER AERO OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '300 mm/11.8 inches'},
 {'Name': 'GIGABYTE RTX 4070 Ti SUPER GAMING OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2655 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '300 mm/11.8 inches'},
 {'Name': 'Inno3D RTX 4070 Ti SUPER X3 OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '297 mm/11.7 inches, Dual-slot'},
 {'Name': 'Manli RTX 4070 Ti SUPER (M2592+N693)',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '264 mm/10.4 inches'},
 {'Name': 'GIGABYTE RTX 4070 Ti SUPER EAGLE OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '261 mm/10.3 inches, Dual-slot'},
 {'Name': 'GIGABYTE RTX 4070 Ti SUPER WINDFORCE OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2625 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '261 mm/10.3 inches, Dual-slot'},
 {'Name': 'ELSA RTX 4070 Ti SUPER S.A.C',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '250 mm/9.8 inches, Dual-slot'},
 {'Name': 'Inno3D RTX 4070 Ti SUPER TWIN X2',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '250 mm/9.8 inches, Dual-slot'},
 {'Name': 'Inno3D RTX 4070 Ti SUPER TWIN X2 OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '250 mm/9.8 inches, Dual-slot'},
 {'Name': 'Inno3D RTX 4070 Ti SUPER TWIN X2 OC WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '250 mm/9.8 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 2X',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '242 mm/9.5 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 2X OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '242 mm/9.5 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 2X WHITE',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2610 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '242 mm/9.5 inches, Dual-slot'},
 {'Name': 'MSI RTX 4070 Ti SUPER VENTUS 2X WHITE OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2640 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '242 mm/9.5 inches, Dual-slot'},
 {'Name': 'Colorful iGame RTX 4070 Ti SUPER Neptune OC',
  'GPU Clock': '2340 MHz',
  'Boost Clock': '2685 MHz',
  'Memory Clock': '1313 MHz',
  'Other Changes': '240 mm/9.4 inches, Dual-slot, 320 W'}]
"""